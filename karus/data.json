{"project":["Test karusell",null,[[0,false,true,true,true,false,false,false,false,false,true,false,false,true,false,false,true],[1,false,true,true,true,false,false,false,false,false,true,false,false,true,false,false,true]],[["iframe",0,false,[],0,0,null,null,[],false,false,833778214635323,[],null,0,null],["HTMLElement",1,false,[],0,0,null,null,[],false,false,265541036205960,[],null,1,null]],[],[["Layout 1",3840,2160,false,false,0.5,0.5,"Event sheet 1",328402020985293,[["Layer 0",0,812106900792159,true,[255,255,255],false,1,1,1,false,false,1,0,true,[[[-3,-1,0,1925,1078,0,0,[1,1,1,1],0,0,0,0,[],null,null,null,["",""]],1,2,[],[],["div","<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n\n  <!-- Include Glide.js CSS and JS from CDN -->\n  <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/css/glide.core.min.css\">\n  <script src=\"https://cdn.jsdelivr.net/npm/@glidejs/glide/dist/glide.min.js\"></script>\n\n  <style>\n    #carousel {\n      max-width: 800px; /* Adjust the max-width as needed */\n      margin: auto;\n      overflow: hidden;\n      border: 2px solid #333; /* Add a border with a color of your choice */\n      border-radius: 8px; /* Add border radius for rounded corners, adjust as needed */\n    }\n\n    .glide__slide {\n      width: 100%;\n      box-sizing: border-box;\n      border-right: 2px solid #333; /* Add a border between slides with the same color */\n    }\n\n    img {\n      width: 100%;\n      height: auto;\n      display: block;\n    }\n  </style>\n</head>\n<body>\n\n  <div id=\"carousel\" class=\"glide\">\n    <div class=\"glide__track\" data-glide-el=\"track\">\n      <ul class=\"glide__slides\"></ul>\n    </div>\n  </div>\n\n  <script>\n    const folderId = '1snDaNtlDD4fSds5I0pLyRPgb7ew6P3ut'; // Replace with your Google Drive folder ID\n    const apiKey = 'AIzaSyD8ktGYC8-v-QznG69SeulPAqTIQMl5eLY'; // Replace with your Google Drive API key\n\n    function fetchImages() {\n      const url = `https://www.googleapis.com/drive/v3/files?q='${folderId}'+in+parents&key=${apiKey}`;\n      fetch(url)\n        .then(response => {\n          if (!response.ok) {\n            throw new Error(`HTTP error! Status: ${response.status}`);\n          }\n          return response.json();\n        })\n        .then(data => {\n          if (data.files) {\n            const images = data.files.filter(file => file.mimeType.startsWith('image/') && hasNotExpired(file));\n            displayImages(images);\n          } else {\n            console.error('No images found in the Google Drive folder.');\n          }\n        })\n        .catch(error => console.error('Error fetching images:', error));\n    }\n\n    function hasNotExpired(file) {\n  // Extract the expiration date from the filename (assuming format DDMMYY)\n  const filename = file.name;\n  const match = filename.match(/(\\d{2})(\\d{2})(\\d{2})/);\n\n  if (!match) {\n    return true; // If no valid expiration date is found, consider it not expired\n  }\n\n  const day = parseInt(match[1], 10);\n  const month = parseInt(match[2], 10);\n  const year = parseInt(match[3], 10) + 2000;\n\n  // Parse the expiration date\n  const expirationDate = new Date(year, month - 1, day);\n\n  // Compare with the current date\n  return expirationDate > new Date();\n}\n\n    function displayImages(images) {\n      const glide = new Glide('#carousel', {\n        type: 'carousel',\n        perView: 1,\n        autoplay: 5000, // Auto-play with a 5-second delay\n        hoverpause: true, // Pause on hover\n      });\n\n      const glideSlides = document.querySelector('#carousel .glide__slides');\n\n      images.forEach(image => {\n        const imageUrl = `https://drive.google.com/uc?id=${image.id}`;\n        const imageElement = document.createElement('li');\n        imageElement.className = 'glide__slide';\n        imageElement.innerHTML = `<img src=\"${imageUrl}\" alt=\"${image.name}\">`;\n        glideSlides.appendChild(imageElement);\n      });\n\n      glide.mount();\n    }\n\n    document.addEventListener('DOMContentLoaded', fetchImages);\n  </script>\n</body>\n</html>\n",0,true,"","",false,0,0,true,[0,0,0],false,[1,1,1],true,false,""]]],[],0,true,false,[]]],[],[]]],[["Event sheet 1",[]]],[],"media/",false,1920,1080,4,false,"trilinear",false,"1.0.0.0",false,false,4,2,3,false,true,1,true,0.7853981633974483,[],"icons/",[],"normalized","5eryzvk4s09","fonts/",[["Timeline 1",5,0.1,"default","default",[],0,0,1,"",1,1]],"high-performance",[],"standard","vsync","","icons/loading-logo.png",false,4,false,null,[],"folders",1,10000,false]}